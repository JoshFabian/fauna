- user = post.user
- comments = post.comments.order('id desc')
- like = PostLike.like?(post, current_user)
- more_likes = PostLike.likes(post).order("id desc").limit(2)
- plus_likes = post.likes_count - 2

.update-panel.rounded-panel{:'data-story-id' => story.id, :'data-story-klass' => story.type, id: "story_#{story.type}_#{story.id}"}
  .small-12.columns
    .user-image
      = link_to user_path(user) do
        = image_tag user_avatar_image_thumbnail(user.avatar_image, 200)
    .user-info
      %h4.story-title
        = link_to user.handle, user_path(user)
      %p.secondary
        %span#ember928.ember-view #{time_ago_in_words(post.created_at)} ago

  .comment-content.small-12.columns.clearfix
    %p.comment-text
      = post.body

  .panel-footer.small-12.columns
    .footer-button
      = link_to '#', class: ['object-like', like ? 'active' : nil], :'data-object-id' => post.id, :'data-object-klass' => 'post' do
        %i.icon.ion-heart.active
        = post.likes_count
    .footer-button
      = link_to '#', class: ['object-comment'] do
        %i.icon.ion-reply
        reply
    %ul.who-liked
      - more_likes.each do |like|
        - user = like.user
        %li.liked
          = link_to user_path(user) do
            = image_tag user_avatar_image_thumbnail(user.avatar_image, 50), title: user.handle, class: 'tip-top', :'data-tooltip' => ''
      - if plus_likes > 0
        %li.more-liked
          %span +#{plus_likes} more

  -# comments
  = render(partial: "users/user_story_comments", locals: {object: post, comments: comments})
      